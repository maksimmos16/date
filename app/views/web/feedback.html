{% extends "web/partation/layout.html" %}

{% block body %}

    <!-- mid part start -->

    <div class="mid-part">
        <div class="container">
            <div class="feedback">
            </div>
        </div>
    </div>
    <!-- mid part end -->
  
    <!-- go premium modal start -->
    <div class="go-premium-modal modal fade " id="go-premium-modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true" >
      <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true"><i class="flava-close"></i></span></button>
          </div>
          <div class="modal-body">
            <div class="go-premium-tab">
                <ul class="nav nav-pills" id="pills-tab" role="tablist">
                  <li class="nav-item">
                    <a class="nav-link active" id="premium-tab" data-toggle="pill" href="#premium" role="tab" aria-controls="premium" aria-selected="true">premium</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" id="get-list-tab" data-toggle="pill" href="#get-list" role="tab" aria-controls="get-list" aria-selected="false">get a list</a>
                  </li>
                  <li class="nav-item">
                    <a class="nav-link" id="get-boost-tab" data-toggle="pill" href="#get-boost" role="tab" aria-controls="get-boost" aria-selected="false">get boost</a>
                  </li>
                </ul>
                <div class="tab-content" id="pills-tabContent">
                  <div class="tab-pane fade show active" id="premium" role="tabpanel" aria-labelledby="premium-tab">
                      <div class="go-premium-row">
                          <div class="row">
                              <div class="col-sm-4">
                                  <div class="go-premium-box">
                                      <div class="purpal-bdr"></div>
                                      <div class="gpb-content">
                                          <div class="month">6 <span>Month</span></div>
                                          <div class="price">$300.00</div>
                                          <a href="#" class="subscribe">subscribe</a>
                                      </div>
                                  </div>
                              </div>
                              <div class="col-sm-4">
                                  <div class="go-premium-box">
                                      <div class="purpal-bdr"></div>
                                      <div class="gpb-content">
                                          <div class="month">3 <span>Month</span></div>
                                          <div class="price">$190.00</div>
                                          <a href="#" class="subscribe">subscribe</a>
                                      </div>
                                  </div>
                              </div>
                              <div class="col-sm-4">
                                  <div class="go-premium-box">
                                      <div class="purpal-bdr"></div>
                                      <div class="gpb-content">
                                          <div class="month">1 <span>Month</span></div>
                                          <div class="price">$80.00</div>
                                          <a href="#" class="subscribe">subscribe</a>
                                      </div>
                                  </div>
                              </div>
                          </div>
                      </div>
                      <div class="modal-footer">
                        <ul class="benefits-ul">
                            <li>Benefits</li>
                            <li>View matched daters</li>
                            <li>Chat with daters</li>
                            <li>Can do video chat</li>
                            <li>Privacy mode is enable</li>
                            <li>Turn off ads</li>
                            <li>1 boost free every month</li>
                            <li>Unlimited likes</li>
                        </ul>
                      </div>
                  </div>
                  <div class="tab-pane fade" id="get-list" role="tabpanel" aria-labelledby="get-list-tab">
                      <div class="go-premium-row">
                          <div class="row">
                              <div class="col-sm-4">
                                  <div class="go-premium-box">
                                      <div class="purpal-bdr"></div>
                                      <div class="gpb-content">
                                          <div class="month">6 <span>Month</span></div>
                                          <div class="price">$250.00</div>
                                          <a href="#" class="subscribe">subscribe</a>
                                      </div>
                                  </div>
                              </div>
                              <div class="col-sm-4">
                                  <div class="go-premium-box">
                                      <div class="purpal-bdr"></div>
                                      <div class="gpb-content">
                                          <div class="month">3 <span>Month</span></div>
                                          <div class="price">$125.00</div>
                                          <a href="#" class="subscribe">subscribe</a>
                                      </div>
                                  </div>
                              </div>
                              <div class="col-sm-4">
                                  <div class="go-premium-box">
                                      <div class="purpal-bdr"></div>
                                      <div class="gpb-content">
                                          <div class="month">1 <span>Month</span></div>
                                          <div class="price">$45.00</div>
                                          <a href="#" class="subscribe">subscribe</a>
                                      </div>
                                  </div>
                              </div>
                          </div>
                      </div>
                      <div class="modal-footer">
                        <ul class="benefits-ul">
                            <li>Benefits</li>
                            <li>Increase likes</li>
                            <li>See more people</li>
                            <li>See all questions and answers</li>
                            <li>All a list basic features</li>
                        </ul>
                      </div>
                  </div>
                  <div class="tab-pane fade" id="get-boost" role="tabpanel" aria-labelledby="get-boost-tab">
                      <div class="go-premium-row">
                          <div class="row">
                              <div class="col-sm-4">
                                  <div class="go-premium-box">
                                      <div class="purpal-bdr"></div>
                                      <div class="gpb-content">
                                          <div class="month">6 <span>Month</span></div>
                                          <div class="price">$325.00</div>
                                          <a href="#" class="subscribe">subscribe</a>
                                      </div>
                                  </div>
                              </div>
                              <div class="col-sm-4">
                                  <div class="go-premium-box">
                                      <div class="purpal-bdr"></div>
                                      <div class="gpb-content">
                                          <div class="month">3 <span>Month</span></div>
                                          <div class="price">$165.00</div>
                                          <a href="#" class="subscribe">subscribe</a>
                                      </div>
                                  </div>
                              </div>
                              <div class="col-sm-4">
                                  <div class="go-premium-box">
                                      <div class="purpal-bdr"></div>
                                      <div class="gpb-content">
                                          <div class="month">1 <span>Month</span></div>
                                          <div class="price">$55.00</div>
                                          <a href="#" class="subscribe">subscribe</a>
                                      </div>
                                  </div>
                              </div>
                          </div>
                      </div>
                      <div class="modal-footer">
                        <ul class="benefits-ul">
                            <li>Benefits</li>
                            <li>Increase likes upto 5 times</li>
                        </ul>
                      </div>
                  </div>
                </div>
            </div>
          </div>
          
        </div>
      </div>
    </div>
    <!-- go premium modal end -->

{% endblock %}

{% block Jscript %}

    <script type="text/javascript" src="/web/js/jquery.min.js"></script>
    <script type="text/javascript" src="/web/js/popper.min.js"></script>
    <script type="text/javascript" src="/web/js/moment.js"></script>
    <script>

        $(function () {

            getQuestions();
        });

        

        function getQuestions(){

            $.ajax({
                url: "/api/feedback/getFeedbackQuestions",
                type: 'POST',
                headers: { 'token': token },
                data:{
                    'userId': userId
                },
                success: function(result){
                    if (result.status == 'success'){

                        console.log("Get Question Function: ",result);
                        createHTML(result);

                    }else{
                        console.log("Get Question Function Error: ",result);
                    }
                }
            });
        }
    
          
        function createHTML(result) {
            
            if(result.data.feedbackQuestionsList){
                
                let html = ` <div class="row lenof">
                                <div class="col-sm-12"> <div class="feedback-title">give your feedback</div></div>`;

                                for(let i = 0; i < result.data.feedbackQuestionsList.length; i++){

                                    html += `<div class="col-lg-5 col-md-6">
                                                <div class="feedback-box">

                                                    <div class="feedback-box-title">`+result.data.feedbackQuestionsList[i].que+`</div>

                                                    <ul class="feedback-box-btn" id="`+result.data.feedbackQuestionsList[i]._id+`">

                                                        <input type="hidden" id="getId`+i+`" value="`+result.data.feedbackQuestionsList[i]._id+`">

                                                        <input type="hidden" id="getLen" value="`+result.data.feedbackQuestionsList.length+`">
                                                          <li>\
                                    <div class="custom-radio">\
                                          <input type="radio" class="custom-control-input" value="`+result.data.feedbackQuestionsList[i].ans[0]+`" name="customRadio`+i+`" id="likeAns`+i+`">\
                                          <label class="custom-control-label" for="likeAns`+i+`"><i class="flava-like"></i></label>\
                                      </div>\
                                </li>\
                                <li>\
                                    <div class="custom-radio">\
                                          <input type="radio" class="custom-control-input" value="`+result.data.feedbackQuestionsList[i].ans[1]+`" name="customRadio`+i+`" id="dislikeAns`+i+`">\
                                          <label class="custom-control-label" for="dislikeAns`+i+`"><i class="flava-dislike"></i></label>\
                                      </div>\
                                </li>\
                                <li>\
                                                                                        
                                                        <li>
                                                            <div class="dropdown">
                                                                <a class="like-comment" href="javascript:void(0)" data-toggle="dropdown"><i class="flava-comment"></i></a>
                                                                <div class="dropdown-menu">
                                                                    <div class="comment-box">
                                                                        <textarea class="form-control" id="comment-`+result.data.feedbackQuestionsList[i]._id+`"></textarea>
                                                                        <div class="save-btn commentSave"><a href="javascript:void(0)">save</a></div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </div>`;
                                }

                            html+=`</div>
                            <div class="row">
                                <div class="col-lg-10 col-md-12">
                                    <div class="testi-textarea">
                                        <div class="form-group">
                                            <label>Testimonial</label>
                                            <textarea class="form-control" id="testimonial"></textarea>
                                            <div class="feedback-btn">
                                                <a href="javascript:void(0)" class="submitBtn">submit</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>`;

                $(".feedback").html(html); 
            }
        }
  
        $('body').on('click', ' .submitBtn', function(e){

            let getLen = Number($("#getLen").val());
            let feedbacks = [];
            for(let i = 0; i < getLen; i++){

                if( i < getLen){

                    let getId = '#getId'+i;
                    let queId = $(getId).val();
                    // console.log("queId -->> ",queId);
                
                    let commentId = '#comment-'+queId;
                    let comment = $(commentId).val();
                    // console.log("comment -->> ",comment);
                     
                    var checkvalue;
                        $.each($("input[name="+'customRadio'+i+"]:checked"), function(){            
                            checkvalue =$(this).val();
                    });
                 
                    // console.log("checkvalue -->> ",checkvalue);
                    if(i == i){
                        feedbacks.push({'queId':queId,'ans':checkvalue,'comment':comment})
                    }
                }
            }
            // console.log("feedback==>",feedbacks)
            let testimonial = $("#testimonial").val();
            let dateId = "5e81fdd4ed36e624e78cc99c";
           // console.log("testimonial -->> ",testimonial);
            // console.log("userId -->> ",userId);
            // console.log("dateId -->> ",dateId);
            // console.log("token -->> ",token);
                $.ajax({
                    url: "/api/feedback/sendFeedback",
                    type: 'POST',
                    headers: { 'token': token },
                    data:{
                    'userId': userId,
                    'dateId':dateId,
                    'feedbacks':feedbacks,
                    'testimonials':testimonial
                    },
                    success: function(result){
                        if (result.status == 'success'){
                            toastr.success(result.message);
                        } else {
                            toastr.error(result.message);

                        }
                    }
                });

        });
    
    </script>

{% endblock %}
